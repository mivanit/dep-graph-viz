<!DOCTYPE html>
<html>
<head>
    <title>Graphviz SVG</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://unpkg.com/@hpcc-js/wasm@0.3.13/dist/index.min.js"></script>
    <script src="https://unpkg.com/d3-graphviz@3.1.0/build/d3-graphviz.min.js"></script>
    <style>
        .node:hover,
        .edge.highlighted {
            stroke: red;
            stroke-width: 2px;
        }
        .edge.highlighted[marker-end] {
            marker-end: url(#arrowhead-red);
        }
    </style>
</head>
<body>
    <div id="graph" style="width: 100%; height: 100vh;"></div>
    <script>
        const dot = `digraph {
rankdir=LR;
"util" [rank=11, shape=folder, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/util"];
ROOT [rank=10, shape=folder, color=purple, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/."];
"config" [rank=11, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/config.py"];
"dep_graph_viz" [rank=11, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/dep_graph_viz.py"];
"html" [rank=11, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/html.py"];
"__main__" [rank=11, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/__main__.py"];
"util.paths" [rank=12, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/util/paths.py"];
"util.util" [rank=12, shape=note, color=black, URL="https://github.com/mivanit/dep-graph-viz/tree/refactor/util/util.py"];
typing [rank=0, shape=box3d, color=purple];
copy [rank=0, shape=box3d, color=purple];
os [rank=0, shape=box3d, color=purple];
subprocess [rank=0, shape=box3d, color=purple];
warnings [rank=0, shape=box3d, color=purple];
pydot [rank=0, shape=box3d, color=purple];
"networkx.drawing.nx_pydot" [rank=0, shape=box3d, color=purple];
dataclasses [rank=0, shape=box3d, color=purple];
"muutils.dictmagic" [rank=0, shape=box3d, color=purple];
fire [rank=0, shape=box3d, color=purple];
networkx [rank=0, shape=box3d, color=purple];
json [rank=0, shape=box3d, color=purple];
"importlib.resources" [rank=0, shape=box3d, color=purple];
importlib [rank=0, shape=box3d, color=purple];
"importlib.metadata" [rank=0, shape=box3d, color=purple];
re [rank=0, shape=box3d, color=purple];
glob [rank=0, shape=box3d, color=purple];
pathlib [rank=0, shape=box3d, color=purple];
ast [rank=0, shape=box3d, color=purple];
"util" -> "util.paths" [key=0, color=black, penwidth=2, style=solid];
"util" -> "util.util" [key=0, color=black, penwidth=2, style=solid];
ROOT -> "util" [key=0, color=black, penwidth=3, style=solid];
ROOT -> "config" [key=0, color=black, penwidth=2, style=solid];
ROOT -> "dep_graph_viz" [key=0, color=black, penwidth=2, style=solid];
ROOT -> "html" [key=0, color=black, penwidth=2, style=solid];
ROOT -> "html" [key=1, color=red, penwidth=1, style=solid];
ROOT -> "__main__" [key=0, color=black, penwidth=2, style=solid];
ROOT -> "__main__" [key=1, color=red, penwidth=1, style=solid];
"config" -> "dep_graph_viz" [key=0, color=red, penwidth=1, style=solid];
"dep_graph_viz" -> ROOT [key=0, color=blue, penwidth=1, style=dashed];
"html" -> "dep_graph_viz" [key=0, color=red, penwidth=1, style=solid];
"util.paths" -> "util" [key=0, color=blue, penwidth=1, style=dashed];
"util.paths" -> "dep_graph_viz" [key=0, color=red, penwidth=1, style=solid];
"util.paths" -> "util.util" [key=0, color=red, penwidth=1, style=solid];
"util.util" -> "dep_graph_viz" [key=0, color=red, penwidth=1, style=solid];
typing -> "config" [key=0, color=purple, penwidth=1, style=dotted];
typing -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
copy -> "config" [key=0, color=purple, penwidth=1, style=dotted];
copy -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
os -> "config" [key=0, color=purple, penwidth=1, style=dotted];
os -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
os -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
os -> "util.util" [key=0, color=purple, penwidth=1, style=dotted];
subprocess -> "config" [key=0, color=purple, penwidth=1, style=dotted];
subprocess -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
warnings -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
warnings -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
warnings -> "util.util" [key=0, color=purple, penwidth=1, style=dotted];
pydot -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
"networkx.drawing.nx_pydot" -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
dataclasses -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
"muutils.dictmagic" -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
fire -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
fire -> "__main__" [key=0, color=purple, penwidth=1, style=dotted];
networkx -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
json -> "dep_graph_viz" [key=0, color=purple, penwidth=1, style=dotted];
json -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
"importlib.resources" -> "html" [key=0, color=purple, penwidth=1, style=dotted];
importlib -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
"importlib.metadata" -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
re -> "util.paths" [key=0, color=purple, penwidth=1, style=dotted];
glob -> "util.util" [key=0, color=purple, penwidth=1, style=dotted];
pathlib -> "util.util" [key=0, color=purple, penwidth=1, style=dotted];
ast -> "util.util" [key=0, color=purple, penwidth=1, style=dotted];
}
`;

        d3.select("#graph").graphviz()
            .renderDot(dot)
            .on("end", function() {
                const graphviz = this;

                d3.selectAll(".node")
                    .on("mouseover", function(d) {
                        const nodeId = d3.select(this).attr("id");
                        console.log("Hovered Node ID:", nodeId);

                        const connectedEdges = graphviz.inEdges(nodeId).concat(graphviz.outEdges(nodeId));
                        console.log("Connected Edges:", connectedEdges);

                        d3.selectAll(".edge")
                            .classed("highlighted", function(d) {
                                return connectedEdges.includes(d3.select(this).node());
                            });
                    })
                    .on("mouseout", function(d) {
                        d3.selectAll(".edge").classed("highlighted", false);
                    });
            });
    </script>
</body>
</html>